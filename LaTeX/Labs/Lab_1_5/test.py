import numpy as np
import matplotlib.pyplot as plt

# Исходные данные
t = np.array([18.4, 18.38, 18.38, 18.41])  # Периоды для одного цикла
phi_0 = np.pi / 6  # Начальная амплитуда
l_1 = 57 / 1000  # Верхний радиус
l_0 = 25 / 1000  # Длина сегмента
b = 40 / 1000  # Высота
m = 405 / 1000  # Масса
g = 9.81  # Ускорение свободного падения
I_0 = 0.008  # Начальный момент инерции

# Периоды колебаний
T = np.mean(t) / 10  # Средний период (делённый на 10 циклов)
t_1 = np.array([37.02, 36.98, 37.38, 37.48])
t_2 = np.array([79.95, 81.24, 81.28, 81.26])
t_3 = np.array([130.81, 133.1, 132.02, 131.39])
t_4 = np.array([193.67, 195.41, 193.3, 193.59])
t_5 = np.array([270.72, 272.67, 271.75, 270.29])

# Средние периоды (в секундах)
T_mean = np.array([np.mean(t_1), np.mean(t_2), np.mean(t_3), np.mean(t_4), np.mean(t_5)]) / 10

# Вычисление момента инерции
R_up = l_1 + b / 2
R_down = l_1 + 5 * l_0 + b / 2
R_side = l_1 + 2 * l_0 + b / 2

I_gr = m * (R_up**2 + R_down**2 + R_side**2)  # Геометрический момент инерции
I = I_gr + I_0  # Полный момент инерции

# График зависимости T^2 от I
T_squared = T_mean**2  # Квадраты периодов

plt.figure(figsize=(12, 6))
plt.plot(I, T_squared, 'o', label='Данные T^2(I)', color='blue')

# Линейная аппроксимация
coeffs = np.polyfit(I, T_squared, 1)
linear_fit = np.polyval(coeffs, I)

plt.plot(I, linear_fit, '--', label=f'Линейная аппроксимация\nk={coeffs[0]:.4f}', color='red')
plt.xlabel('Момент инерции I (кг·м²)')
plt.ylabel('$T^2$ (с²)')
plt.title('Зависимость $T^2(I)$')
plt.grid(True)
plt.legend()

# Вывод углового коэффициента
print('Коэффициенты линейной аппроксимации:', coeffs)

# Нахождение произведения ml из углового коэффициента
# Угловой коэффициент k = (4π²)/(mg·l)
k = coeffs[0]
ml = (4 * np.pi**2) / (k * g)  # Вычисление произведения ml
print(f"Произведение ml = {ml:.4f} м·кг")

plt.show()
